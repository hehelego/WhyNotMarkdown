[TOC]

## ODE 初步

### ODE入门解法

- fisrt-order ODE
  - 可分离变量: 一阶微分形式不变性,直接积分
  - 齐次方程: 换元$u=\frac{y}{x},\mathrm{d}(y)=\mathrm{d}(ux)=u\mathrm{d}x+x\mathrm{d}u$之后可以分离变量
  - 一阶线性微分方程: (积分因子法:构造出可分离变量的微分方程;常数变易法:线性齐次方程的解构造出线性非齐次的方程的解)  
  $y'+p(x)y$类似乘法求导即$(uy)'=uy'+u'y$,给原方程乘上一个$v$以构造$(uy)'$有  
  $vy'+vp(x)y=uy'+u'y$于是$v=u,vp(x)=u'=v'$解出一个$v$即可,比如$v=e^{\int p(x)\mathrm{d}x}$  
  得到$\left(ye^{\int p(x)\mathrm{d}x}\right)'=-q(x)e^{\int p(x)\mathrm{d}x}$.
- second-order linear ODE
  - $y''+p(x)y'+q(x)y=f(x)$,和对应的齐次(homogeneous)方程$y''+p(x)y'+q(x)y=0$
  - 解存在性条件,解唯一性条件,解空间结构: 引入Wronskian(朗斯基行列式).
    - the set of all solution of a $n$-th order linear homogeneous ODE forms a $n$-dimensional vector space.
    - the set of all solution of a $n$-th order linear ODE forms a affine spcae.
    - if $y_1,y_2,y_3\ldots y_n$ is linearly dependent, then
      $$W(x)=\begin{vmatrix}y_1^{(0)}&y_2^{(0)}&\ldots &y_n^{(0)}\\ y_1^{(1)}&y_2^{(1)}&\ldots &y_n^{(1)}\\ \vdots&\vdots &\ldots &\vdots\\ y_1^{(n-1)}&y_2^{(n-1)}&\ldots &y_n^{(n-1)}\\ \end{vmatrix}\equiv 0(x)$$
    - **However**, $W(x)\equiv 0(x)$ on interval $I$ doesn't mean that $y_1,y_2\ldots y_n$ are linearly dependent.
  - Liouville公式: $y''+p(x)y'+q(x)y=0$两个解$y_1(x),y_2(x)$的Wronskian有一定特殊性(一点为0,全局为0; 一点非0,全局非0)  
    $$\begin{aligned} W(x)&=y_1y_2'-y_1'y_2\\ W'(x)&=(y_1'y_2'+y_1y_2'')-(y_1''y_2+y_1'y_2')=y_1y_2''-y_1''y_2\\ &=-y_1\left(p(x)y_2'+q(x)y_2\right)+(p(x)y_1'+q(x)y_1)y_2\\ &=-(y_1y_2'-y_1'y_2)p(x)+(-y_1y_2+y_1y_2)q(x)\\ &=-W(x)\\ \implies &W(x)=W(x_0)e^{\int_{x_0}^{x}-p(t)\mathrm{d}t} \end{aligned}$$
  - 求$y''+p(x)y'+q(x)=f(x)$的解空间,  
    需要$y''+p(x)y'+q(x)y=0$的解空间(由两个线性无关解$y_1,y_2$张成)  
    和一个非齐次方程的特解.
    - 常数变易法(求特解):  
      1. 线性齐次方程的解为$C_1y_1+C_2y_2$.
      2. 假设将常数用$x$的函数替换可以得到线性非齐次方程的解
      即$y=C_1(x)y_1+C_2(x)y_2$为线性非齐次方程的解
      3. 计算$y',y''$有  
      $y'=(C_1'y_1+C_2'y_2)+(C_1y_1'+C_2y_2')$  
      为了防止$y''$中出现$C''$(那样的话,我们会得到关于$C$的二阶ODE,无法规约为更简单的情况),  
      我们假设$C_1'y_1+C_2'y_2=0$于是$y'=C_1y_1'+C_2y_2'$  
      $y''=C_1'y_1'+C_1y_1''+C_2'y_2'+C_2y_2''$
      4. 将上述导数带入原来的线性非齐次方程,利用$y_1,y_2$为齐次方程的解,  
      即$y_1''+p(x)y_1'+q(x)y_1=y_2''+p(x)y_2'+q(x)y_2=0$化简方程,  
      得到$C_1'y_1'+C_2'y_2'=f(x)$
      5. 下式中$x_0$为区间上任意一点.  
      $$\begin{aligned} &\begin{cases} C_1'y_1+C_2'y_2&=0\\ C_1'y_1'+C_2'y_2'&=f(x) \end{cases} \implies \begin{cases} C_1(x)=-&\int_{x_0}^{x}\frac{y_2(t)f(t)}{W(t)}\mathrm{d}{t}\\ C_2(x)=&\int_{x_0}^{x}\frac{y_1(t)f(t)}{W(t)}\mathrm{d}{t}\\ \end{cases}\\ &\implies y(x)=\int_{x_0}^{x} \frac{y_1(t)y_2(x)-y_2(t)y_1(x)}{W(t)}f(t)\mathrm{d}t \end{aligned}$$
    - 已知线性齐次ODE的一个non-trival solution,构造出另一个与之线性无关的解:  
      1. 已知$y_1''+p(x)y_1'+q(x)y_1=0$,求$y_2$满足线性齐次ODE,且与$y_1$线性无关.
      2. Wronskian的两种表达  
      $$W(x)=W(x_0)e^{\int_{x_0}^x -p(t)\mathrm{d}t}={(y_1)}^2\ \frac{y_1y_2'-y_2y_1'}{{(y_1)}^2}={(y_1)}^2\left(\frac{y_2}{y_1}\right)'$$
      线性齐次方程,解乘上一个常数仍然是解,所以我们可以丢弃$W(x_0)$和$\int_{x_0}^x -p(t)\mathrm{d}t$的积分下限.  
      $$e^{\int -p(x)\mathrm{d}x}={(y_1)}^2\left(\frac{y_2}{y_1}\right)' \qquad \left(\frac{y_2}{y_1}\right)' = \frac{\exp\left(\int -p(x)\mathrm{d}x\right)}{{(y_1)}^2}$$  
      同样地,舍弃常数,得到任意一个满足上述方程的$y_2$即可.
    - 求线性齐次ODE的解: 利用微分算子;观察形式待定系数;各种玄学.
- reduction
  - 经典的降次
    - Bernoulli方程: $y'+p(x)y=q(x)y^n$, 除掉$y^n$有  
      $y^{-n}y'+p(x)y^{n-1}=\left(y^{n-1}\right)'+p(x)\left(y^{n-1}\right)=q(x)$
    - $F(x,y',y'')=0$换$u=y'$有$F(x,u,\frac{\mathrm d u}{\mathrm d x})=0$
    - $F(y,y',y'')=0$换$p=\frac{\mathrm dy}{\mathrm d x},\frac{\mathrm{d}^2 y}{\mathrm{d} x^2}=\frac{\mathrm d p}{\mathrm d x}=\frac{\mathrm d p}{\mathrm dy}\frac{\mathrm d y}{\mathrm dx}=p\frac{\mathrm d p}{\mathrm d y}$有$F(y,p,p\frac{\mathrm d p}{\mathrm d y})$
  - 其他方法...整体换元,三角换元,玄妙降阶.


(Homogeneous equation with constant coefficients)    
求常系数(有理数/实数/复数都可以)线性齐次ODE的解 $y^{(n)}+\sum_{i=0}^{n-1} a_i y^{(i)}=0$  
特征方程法(求形如$y=e^{\lambda x}$的解,寻找解空间的基),设$y=e^{\lambda x}$有$y^{(n)}=\lambda^n y$代入  
$$\lambda^n e^{\lambda x}+\sum_{i=0}^{n-1} \lambda^i a_i e^{\lambda x}=0\iff \lambda^n+\sum_{i=0}^{n-1} a_i \lambda^i =0$$  
由代数学基本定理,该方程有$n$个根,对应原方程的$n$个解.  
- 不相等的根对应的函数,显然线性无关.
- (实系数情况)对于共轭根$\lambda ,\overline{\lambda}$,线性组合可以得到两个$\mathbb{R}\to\mathbb{R}$的函数  
$$\begin{aligned} &e^{(a+bi)x}=e^a(\cos bx+i\sin bx)\quad e^{(a-bi)x}e^a(\cos bx-i\sin bx)\\ &\frac{e^{(a+bi)x}+e^{(a-bi)x}}{2}=e^a\cos bx\quad \frac{e^{(a+bi)x}-e^{(a-bi)x}}{2i}=e^a\sin bx \end{aligned}$$
- 出现$k$重根,有$0=(\lambda-\lambda_0)^k P_{n-k}(\lambda )$形式的特征方程,  
做常数变易,设$C(x)e^{\lambda_0 x}$根,带入原方程,可以得到  
$e^{\lambda_0 x},\, xe^{\lambda_0 x},\ x^2e^{\lambda_0 x}\ldots x^{k-1}e^{\lambda_0 x}$
这样一组$k$个线性无关的解.
- 于是我们找的了$n$个线性无关的解,它们的span就是原线性齐次ODE的解.

更进一步地,配合使用常数变易法,可以解出任意的$n$阶常系数线性非齐次ODE.

> reminder,对于整系数多项式方程,其有理数根的最简形式满足: 分子是常数项的约数而分母是最高次项的系数.  
> 这对于求解高次常系数线性齐次ODE的特征方程很有帮助  
> Given that $P(x)=\sum_{i=0}^n a_i x^i\in \mathbb{Z}[x]$ and $P(\frac{p}{q})=0\ \mathrm{gcd}(p,q)=1$ we can show that $p\mid a_0\land q\mid a_n$  




## 多元函数微分学

### a
### b 
### c

### Taylor of multi-var

以二元函数为例,$(x,y)\to (x+h,y+k)$假设偏导都是连续(推出可以换序)  
令$g(t)=f(x+th,y+tk)\quad t\in [0,1]$在$0$处展开,求$1$处的值(收敛性之类的先不做讨论,暂且只考虑形式)

$$
\begin{aligned}
g(1)
&=f(x+h,y+k)\\
&=\sum_{k=0}^n \frac{g^{k}(0)}{k!}{(1-0)}^k + R_n\\
&=R_n+\sum_{k=0}^n \frac{1}{k!}\sum_{i=0}^k
  \binom{k}{i}\frac{\partial^{k} f}{\partial x^{i}\partial y^{k-i}}(x+0h,y+0k)
  {\left(\frac{\mathrm{d} (x+th)}{t}\right)}^{i}
  {\left(\frac{\mathrm{d} (y+tk)}{t}\right)}^{k-i}\\
&=R_n+\sum_{k=0}^n \frac{1}{k!}\sum_{i=0}^k
  \binom{k}{i}h^{i} k^{k-i}\frac{\partial^{k} f}{\partial x^{i}\partial y^{k-i}}(x,y)
\end{aligned}
$$

其中余项
- Peaon: $R_n=o({(1-0)}^n)=o(1)$ 这个太弱,没有什么使用意义.
- Lagrange: $\exists \xi \in (0,1)\quad R_n=\frac{1}{(n+1)!}\sum_{i=0}^{n+1}\binom{n+1}{i}h^i k^{n+1-i} \frac{\partial^{n+1}f}{\partial x^{i}\partial y^{n+1-i}}(x+\xi h,y+\xi k)$

Lagrange余项比较有用,但是形式过于复杂,不易估计其大小,我们会尝试寻找类似一元函数中Peaon余项的$o\left({\left(\sqrt{h^2+k^2}\right)}^n\right)$  

令$\displaystyle L=\max_{0\leq i\leq n+1}\left\{\frac{\partial^{n+1}f}{\partial x^{i}\partial y^{n+1-i}}(x+\xi h,y+\xi k)\right\}\quad u=|h|,v=|k|$我们估算Lagrange余项的大小.

$$
\begin{aligned}
\left\vert R_n\right\vert 
&=
\frac{1}{(n+1)!}\sum_{i=0}^{n+1}\binom{n+1}{i}h^i k^{n+1-i} \frac{\partial^{n+1}f}{\partial x^{i}\partial y^{n+1-i}}(x+\xi h,y+\xi k)\\
&\leqslant 
\frac{L}{(n+1)!}\sum_{i=0}^{n+1}\binom{n+1}{i}u^i v^{n+1-i}\\
&=\frac{L}{(n+1)!}{(u+v)}^{n+1}\\
\implies
\frac{|R_n|}{{\left(\sqrt{h^2+k^2}\right)}^n}
&=\frac{L}{(n+1)!}(u+v) \cdot {\left(\frac{u+v}{\sqrt{h^2+k^2}}\right)}^n\\
&=\frac{L}{(n+1)!}(u+v) \cdot {\left(\frac{u+v}{\sqrt{u^2+v^2}}\right)}^n\\
\end{aligned}
$$

做一下直角座标道极座标的变换,有$r=\sqrt{u^2+v^2}\quad \exists \theta\in \left[0,\frac{\pi}{4}\right]\ u=r\sin \theta,v=r\cos\theta$

$$
\begin{aligned}
\frac{|R_n|}{{\left(\sqrt{h^2+k^2}\right)}^n}
&=\frac{Lr}{(n+1)!}(\cos\theta+\sin\theta) \cdot {\left(\frac{r(\cos\theta+\sin\theta)}{r}\right)}^n\\
&=\frac{Lr}{(n+1)!}(\cos\theta+\sin\theta) \cdot {(\cos\theta+\sin\theta)}^n\\
&=\frac{Lr}{(n+1)!}\sin^{n+1}(\theta+\frac{\pi}{4})\\
&\to 0\qquad (\text{when }r\to 0)
\end{aligned}
$$


于是二元函数的Taylor展开中的Lagrange余项,类似一元中的情况,是$O({\left[\sqrt{h^2+k^2}\right]}^n)$的,  

- 余项大小估计的结论可以类似地进行推广,得到$R^d\to R$的函数的Taylor展开,
给出差异被${||\Delta \vec x||}^{n}$控制的估计.
- 多元函数的taylor展开,也一样是有"唯一性"的,
即$f$在$\vec{x}_0$附近的一个$n$次多项式近似,
如果差异是$o({||\Delta \vec x||}^{n})$的,
那么这个多项式一定是$f$在该点的$n$阶泰勒多项式.
- 多元函数也可以有Taylor series.
- 这种形式,对其进行抽象,可以搞出多元形式幂级数.

## 多元函数积分学


## 曲线积分和曲面积分


## Fourier分析

## 广义积分和参变量的积分


## MISC

### Cantor's intersection theorem

> Given a sequence of compact,non-empty,cloesd set $S_0\supset S_1\supset S_2\ldots \text{ s.t. } \lim_{n\to \infty} \mathrm{diam}(S_n)=0$  
> > $$\renewcommand{\vec}[1]{\overrightarrow{#1}}\mathrm{diam}(S)=\sup_{\vec{x_0},\vec{x_1}\in S} ||\vec{x_0}-\vec{x_1}||$$
> Show that $\cap_{n=0}^{\infty} S_n=\{x\}$


Let $T_k=S_{k+1}\setminus S_k\text{ and }T=\{T_0,T_1\ldots\}$.  
By axiom-of-choice, we can select a series $a_n=\{a_0,a_1\ldots\}\text{ s.t. }\forall n\ a_n\in T_n,a_n\in S_{k+1}$  
We can see that $i\neq j\implies T_i\cap T_j=\emptyset$. Thus $a_i\neq a_j$   

Consider the convergency of $\{a_n\}$.

Since $\mathrm{diam}(S_n)\to 0$, $\forall \epsilon>0\ \exists N\text{ s.t. }\forall n>N\ \mathrm{diam}(S_n)<\epsilon$  
$\forall n>m>N\quad ||a_n-a_m||\leq \mathrm{diam}(S_{m+1})<\epsilon$.  
By Cauchy's theorem, the series converges. Let $x=\lim_{n\to \infty} a_i$


$\forall m,\text{let }b=\{a_m,a_{m+1},a_{m+2}\ldots \}\to x$ and $\forall i\geq m\  a_i\in S_m$. Since $S_m$ is a cloesd set and there is no duplicate elements in $b$, the limit $x$ is in $S_m$.  
Therefor $\forall m\ x\in S_m$, which is exactly $x\in \cap_{n=0}^{\infty} S_n$.  

Finally, we can prove that $x$ is the unique element in $\cap_{n=0}^{\infty} S_n$ by using $\mathrm{diam}(S_n)\to 0$ again.


> 要点
> - A.C.
> - 选点避免重复. 闭集对于这种不重复的序列,取极限后,极限仍然在该闭集中.



### 连续映射一定将闭集映射到闭集吗?

$S=\{(\frac{1}{n},n)\mid n\in \mathbb{N}^+\}$,和$f(x,y)=x$.  

- 考察$T=\overline{S}$,显然有$\partial T\cap T=0$即$T$开,故$S$闭.  
- 考虑$f$,这是个连续映射

但是$f(S)=\{\frac{1}{n}\mid n\in\mathbb{N}^+\}$它有一个聚点$0$是其本身的元素.  
这并非一个闭集. 


但可以强化条件: 有界开集在连续映射下一定得到闭集.





