### intro

一个环,上面$n$个点,编号为$(0,1,2\dots n-1)$的点,$i$与$(i+1)\bmod n$之间有双向边.
要完成一个互相运输任务,使环上每个点达到一个想要的状态,最小化总运量.



### description

我们设$(i,(i+1)\bmod n)$之间的边$i\rightarrow (i+1)\bmod n$方向运输量为$x_i$(反向运输符号取$-$).
设点$i$需要的增量是$y_i$增加为正,减少为负(满足$\sum y_i=0$)
于是可以列出$n$个方程.以及最小化目标
$$
\begin{cases}
-x_0+x_{n-1}&=y_0\\
-x_1+x_0&=y_1\\
-x_2+x_1&=y_2\\
\vdots\\
-x_i+x_{i-1}&=y_i\\
\vdots\\
-x_{n-1}+x_{n-2}&=y_{n-1}
\end{cases}\\

\Rightarrow \min (\sum |x_i|)
$$

然后就能解出来$\vec x=(x_0,x_1\dots x_{n-1})$,确定唯一可行解了吗?
哦并不,我们发现这$n$个方程并非线性无关…前面$n-1$个方程求和,可以得到第$n$个方程.
$$
LHS=(-x_0+x_{n-1})+(-x_1+x_0)\dots (-x_{n-2}+x_{n-3})=x_{n-1}-x_{n-2}\\
RHS=\sum_{i=0}^{n-2}y_i=\sum_{i=0}^{n-1} y_i-y_{n-1}=0-y_{n-1}\\
\Rightarrow 
y_{n-1}=-x_{n-1}+x_{n-2}
$$

### solution

但是我们仍然可以尝试解方程,哦不,是消元.
原始最优化目标函数是个$n$元函数,我们这里最大线性无关方程集合大小是$n-1$,于是我们可以削掉$n-1$个元,只留下唯一自由变量,这样会把目标函数变成$1$元函数.



具体来说.
$$
\begin{cases}
x_0&=\text{var: }x\\
x_1&=x_0-y_1\\
x_2&=x_1-y_2&=x-y_1-y_2\\
x_3&=x_2-y_3&=x-y_1-y_2-y_3\\

\dots \\
x_i&=x_{i-1}-y_i&=x-\sum_{j=1}^iy_i\\
\dots \\

x_{n-1}&=x_0+y_0&=x-\sum_{j=1}^{n-1}y_i
\end{cases}\\
\text{let } A_k=\sum_{i=1}^k y_k\ A_0=0\\
x_i=x-A_i \Rightarrow \min(\sum |x-A_i|)
$$


最后这个东西,它是非常好的几何意义的.绝对值就是向量模.
而现在是一维向量(就是实数标量),这里的模就是直线上两点距离.
然后我们可以非常自然地说明$x=median(A)​$是最优的.

若不然,假设最优位置的$p$,向令$p$向$median(A)$移动可以使得目标函数的函数值减小,说明$p$并非是目标函数的极小值点,当然也不可能是最小值点了.



### review

最后回顾这个解题过程,我们其实用不上$\sum y_i=0$这个条件.

对于整数解计数的问题,就是对$x_0$计数,对于奇数显然是唯一或者无解.对于偶数就是区间内的整数个树.

